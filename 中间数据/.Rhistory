facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y))+
geom_line(color="tomato",linetype=1,size=1)+
geom_point(size=3,color="tomato")+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=1)+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y))+
geom_line(color="tomato",linetype=1,size=1)+
geom_point(size=3,color="tomato")+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(color="tomato",linetype=1,size=1)+
geom_point(size=3,color="tomato")+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
tmp=all_region[all_region$region==region,]
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("#FF3030","#FF7F50","FFA54F"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("#FF3030","#FF7F50","#FFA54F"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("#FF3030","#FF6347","#FF7256"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("tomato","orange","#FF7256"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("tomato","EE7942","orange"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_manual(values=c("tomato","#EE7942","orange"))+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
?scale_color_brewer
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Reds")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "RdPu,")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "RdPu")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "RdBu")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "RdGy")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "RdYlBu")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = " Spectral")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Pastel1")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Pastel2")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Paired")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Accent")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Dark2")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Set1")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
pfun("全球")
pfun=function(region){
tmp=all_region[all_region$region==region,]
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Set1")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
}
pfun("全球")
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图1.pdf",width = 8,height = 6)
pfun("全球")
dev.off()
option(warning=-1)
option=(warning=-1)
pfun=function(region){
option=(warning=-1)
tmp=all_region[all_region$region==region,]
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Set1")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
}
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图1.pdf",width = 8,height = 6)
pfun("全球")
pfun=function(region){
options(warn=-1)
tmp=all_region[all_region$region==region,]
ph1=ggplot(data=tmp,aes(x=year,y=y,color=fill))+
geom_line(linetype=1,size=1)+
geom_point(size=3)+
geom_point(size=0.1,color="white",aes(y=y*1.1))+
geom_text(data=tmp[tmp$year%in%c(1990,2000,2007),],
aes(x=year,y=y,label=y),vjust=-1)+
scale_color_brewer(palette = "Set1")+
scale_x_continuous(limits=c(1990,2007),
breaks=c(1990:2007),
labels=as.character(1990:2007))+
labs(x="年份",y="")+
theme(legend.position = "None",
axis.title=element_text(size=18),
axis.text.y=element_text(size=10),
axis.text.x=element_text(size=10,angle=45,
vjust=1,hjust=0.9))+
facet_wrap(~fill,ncol=1,scales = "free_y")
print(ph1)
}
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图1.pdf",width = 8,height = 6)
pfun("全球")
dev.off()
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图2.pdf",width = 8,height = 6)
pfun("全球")
dev.off()
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图2.pdf",width = 8,height = 5)
pfun("全球")
dev.off()
pdf("~/Documents/作业/数据可视化作业/第三次作业2/图2.pdf",width = 8,height = 4)
pfun("全球")
dev.off()
